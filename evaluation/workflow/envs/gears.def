Bootstrap: docker
From: mambaorg/micromamba

%post
    export CONDA_OVERRIDE_CUDA="11.6"
    micromamba install -n base -y -c conda-forge -c pyg \
        pytorch-gpu \
        pyg \
        numpy \
        pandas \
        tqdm \
        scikit-learn \
        scanpy \
        networkx \
        dcor \
        tbb \
        filelock \
        pyyaml \
        anndata
    micromamba run pip install --no-cache-dir --no-deps cell-gears
    micromamba clean -y -a

%runscript
    exec micromamba run python "$@"
